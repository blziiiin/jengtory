<!DOCTYPE html>
<html lang="en">
    <head>
        <title>JengDle</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE-edge">
        <meta name="viewport" content="width=device-width,initial-scale=1.0">

        <link rel="stylesheet" href="wordle.css">
    </head>
    <body>
        <h1 id="title">Equadle</h1>
        <hr>
        <br>
        <div id="board">

        </div>

        <br>
        <h1 id="answer"></h1>
        
<!--        키패드 만들기-->
        <input id = "0" type="button" value="0" onclick="fillBox(0)"/>
        <input id = "1" type="button" value="1" onclick="fillBox(1)"/>
        <input id = "2" type="button" value="2" onclick="fillBox(2)"/>
        <input id = "3" type="button" value="3" onclick="fillBox(3)"/>
        <input id = "4" type="button" value="4" onclick="fillBox(4)"/>
        <input id = "5" type="button" value="5" onclick="fillBox(5)"/>
        <input id = "6" type="button" value="6" onclick="fillBox(6)"/>
        <input id = "7" type="button" value="7" onclick="fillBox(7)"/>
        <input id = "8" type="button" value="8" onclick="fillBox(8)"/>
        <input id = "9" type="button" value="9" onclick="fillBox(9)"/>
        <input type="button" value="+" onclick="fillBox2(0)"/>
        <input type="button" value="-" onclick="fillBox2(1)"/>
        <input type="button" value="×" onclick="fillBox2(2)"/>
        <input type="button" value="÷" onclick="fillBox2(3)"/>
        <input id = "=" type="button" value="=" onclick="fillBox2(4)"/>
        <input type="button" value="Backspace" onclick="erase()"/>
        <input type="button" value="Enter" onclick="enter()"/>

        <script>
            let height = 6; // 줄 갯수 
            let width = 6; // 단어 길이

            let row = 0; // 현재 줄 (attempt #)
            let col = 0; // 현재 알파벳 인덱스 

            let gameOver = false;
            let word = "2×9=18";
            
            window.onload = function() {
                initialize();
            };
            
            function initialize() {
                // 보드 만들기
                for (let r = 0; r < height; r++) {
                    if (r === 0) {
                        // 첫 줄 예시로 채우기
                        for (let c = 0; c < width; c++) {
                            //<span id="0-0" class="tile"></span>
                            let tile = document.createElement("span"); 
                            tile.id = r.toString() + "-" + c.toString(); 
                            tile.classList.add("tile");
                            tile.innerText = "2+8=10"[c];
                            tile.classList.add("eg");
                            document.getElementById("board").appendChild(tile); 
                        }
                    }
                    else {
                        for (let c = 0; c < width; c++) {
                            //<span id="0-0" class="tile"></span>
                            let tile = document.createElement("span"); 
                            tile.id = r.toString() + "-" + c.toString(); 
                            tile.classList.add("tile");
                            tile.innerText = "";
                            document.getElementById("board").appendChild(tile); 
                        }
                    }
                    
                }
                row += 1;
            };
            
            function fillBox(w) {
                // 키패드를 누르면 실행되는 부분
                if(gameOver) return;
                if (col < width) {
                    let currTile = document.getElementById(row.toString() + "-" + col.toString());
                    if (currTile.innerText === "") {
                        currTile.innerText = w;
                        col += 1;
                    }
                    let target = document.getElementById(w.toString());
                    target.disabled = true;
                }
            };
            
            function fillBox2(w) {
                // 키패드를 누르면 실행되는 부분
                if(gameOver) return;
                if (col < width) {
                    let currTile = document.getElementById(row.toString() + "-" + col.toString());
                    if (currTile.innerText === "") {
                        currTile.innerText = "+-×÷="[w];
                        col += 1;
                    }
                }
                if (w === 4) {
                    let target = document.getElementById("=");
                    target.disabled = true;
                }
            };
            
            function erase() {
                // 키패드를 누르면 실행되는 부분
                if(gameOver) return;
                if (0 < col && col <= width) {
                    col -= 1;
                }
                let currTile = document.getElementById(row.toString() + '-' + col.toString());
                let w = currTile.innerText;
                if ("0123456789=".includes(w)) {
                    document.getElementById(w).disabled = false;
                }
                currTile.innerText = "";
            };
            
            function enter() {
                // 키패드를 누르면 실행되는 부분
                if(gameOver) return;
                if (col === width) {
                    update();
                    // 다시 모든 버튼 활성화
                    for (let i = 0; i<11; i++) {
                        document.getElementById("0123456789="[i]).disabled = false;
                    }
                    row += 1; // start new row
                    col = 0;  // start at 0 for new row
                }
                if (!gameOver && row === height) {
                    gameOver = true;
                    document.getElementById("answer").innerText = word;
                }
            };
            
            function update() {
                let correct = 0;
                for (let c = 0; c < width; c++) {
                    let currTile = document.getElementById(row.toString() + '-' + c.toString());
                    let letter = currTile.innerText;

                    // letter가 맞는 자리에 있는가?
                    if (word[c] === letter) {
                        currTile.classList.add("correct");
                        correct += 1;
                    } // letter가 정답에 존재하는가? 
                    else if (word.includes(letter)) {
                        currTile.classList.add("present");
                    } // letter 정답에 없음? 
                    else {
                        currTile.classList.add("absent");
                    }
                    // 정답을 맞추면 게임오버 
                    if (correct === width) {
                        gameOver = true;
                    }
                }
            };
        </script>
    </body>
</html>